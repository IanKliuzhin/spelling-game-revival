(this["webpackJsonpspelling-game-p2p"]=this["webpackJsonpspelling-game-p2p"]||[]).push([[0],{40:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var s,a=n(26),i=n.n(a),r=(n(40),n(1)),c=function(e){var t=e.children;return Object(r.jsx)("div",{className:"globalWrapper",children:t})},o=n(13),l=n(2),d=n(6),u=n(31),m=n(4),h=n(18),f=n(9),j=n.n(f),v=n(14),b=n(32),g=n(11),S=n(35),p={apiKey:"AIzaSyB0LaSTOstSw6X_3qVzPrO6hRmC1xZCy80",authDomain:"spelling-game-revival.firebaseapp.com",projectId:"spelling-game-revival",databaseURL:"https://spelling-game-revival-default-rtdb.europe-west1.firebasedatabase.app/",storageBucket:"spelling-game-revival.appspot.com",messagingSenderId:"632958042616",appId:"1:632958042616:web:42361877cf665fb742160d"};!function(e){e.START_GAME="start-game",e.START_BATTLE="start-battle",e.REDUCE_LIFES="reduce-lifes",e.FINISH_EXERCISE="finish-exercise",e.END_GAME="end-game",e.REQUEST_RESTART="request-restart",e.GIVE_UP="give-up"}(s||(s={}));var O,x,R,N={iceServers:[{urls:"stun:stun2.1.google.com:19302"}]},w=function e(t){var n=this,a=t.rootStore;Object(l.a)(this,e),this.db=void 0,this.connectionId=null,this.connection=null,this.channel=null,this.isConnected=!1,this.rootStore=void 0,this.setIsConnected=function(e){n.isConnected=e},this.startHostSession=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.connection=new RTCPeerConnection(N),n.connectionId=Object(S.a)(5),n.connection.oniceconnectionstatechange=function(){var e;"disconnected"===(null===(e=n.connection)||void 0===e?void 0:e.iceConnectionState)&&n.rootStore.gameStore.abortGame()},n.connection.onicecandidate=function(e){e.candidate&&Object(g.e)(Object(g.c)(n.db,"".concat(n.connectionId,"/host-candidate")),{value:JSON.stringify(e.candidate)})},n.setChannel(n.connection.createDataChannel("channel")),e.next=7,n.connection.createOffer();case 7:return t=e.sent,e.next=10,n.connection.setLocalDescription(t);case 10:return e.next=12,Object(g.e)(Object(g.c)(n.db,"".concat(n.connectionId,"/offer")),{value:JSON.stringify(t)});case 12:Object(g.b)(Object(g.c)(n.db,"".concat(n.connectionId,"/answer")),(function(e){if(n.connection&&e.exists()){var t=JSON.parse(e.val().value);n.connection.setRemoteDescription(t)}})),Object(g.b)(Object(g.c)(n.db,"".concat(n.connectionId,"/client-candidate")),(function(e){if(n.connection&&e.exists()){var t,s=JSON.parse(e.val().value);null===(t=n.connection)||void 0===t||t.addIceCandidate(new RTCIceCandidate(s)),n.setIsConnected(!0)}}));case 14:case"end":return e.stop()}}),e)}))),this.startClientSession=function(){var e=Object(v.a)(j.a.mark((function e(t){var s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.connectionId=t,n.connection=new RTCPeerConnection(N),s=function(e){n.setChannel(e.channel)},n.connection.ondatachannel=s,n.connection.onicecandidate=function(e){e.candidate&&Object(g.e)(Object(g.c)(n.db,"".concat(n.connectionId,"/client-candidate")),{value:JSON.stringify(e.candidate)})},Object(g.b)(Object(g.c)(n.db,"".concat(n.connectionId,"/offer")),function(){var e=Object(v.a)(j.a.mark((function e(t){var s,a,i,r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.connection||!t.exists()){e.next=12;break}return r=JSON.parse(t.val().value),e.next=4,null===(s=n.connection)||void 0===s?void 0:s.setRemoteDescription(r);case 4:return e.next=6,null===(a=n.connection)||void 0===a?void 0:a.createAnswer();case 6:return c=e.sent,e.next=9,null===(i=n.connection)||void 0===i?void 0:i.setLocalDescription(c);case 9:return e.next=11,Object(g.e)(Object(g.c)(n.db,"".concat(n.connectionId,"/answer")),{value:JSON.stringify(c)});case 11:Object(g.b)(Object(g.c)(n.db,"".concat(n.connectionId,"/host-candidate")),(function(e){if(e.exists()){var t,s=JSON.parse(e.val().value);null===(t=n.connection)||void 0===t||t.addIceCandidate(new RTCIceCandidate(s)),n.setIsConnected(!0)}}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setChannel=function(e){n.channel=e,n.channel.onmessage=function(e){var t=JSON.parse(e.data);console.log("got data by channel",t),n.handleMessage(t)},n.channel.onclose=function(){n.rootStore.gameStore.abortGame()}},this.sendMessage=function(e){var t;null===(t=n.channel)||void 0===t||t.send(JSON.stringify(e))},this.closeConnection=function(){var e,t;Object(g.d)(Object(g.c)(n.db,"".concat(n.connectionId))),null===(e=n.channel)||void 0===e||e.close(),null===(t=n.connection)||void 0===t||t.close(),n.channel=null,n.connection=null,n.connectionId=null,n.isConnected=!1},this.handleMessage=function(e){switch(e.type){case s.START_GAME:n.rootStore.gameStore.startGame();break;case s.START_BATTLE:n.rootStore.gameStore.startBattle(e.exercise);break;case s.REDUCE_LIFES:n.rootStore.gameStore.reduceRivalLifes();break;case s.FINISH_EXERCISE:n.rootStore.gameStore.saveBattleResult({secondsLeft:e.secondsLeft,lifesLeft:e.lifesLeft},!0);break;case s.END_GAME:n.rootStore.gameStore.endGame();break;case s.REQUEST_RESTART:n.rootStore.gameStore.saveRestartRequest(!0);break;case s.GIVE_UP:n.rootStore.gameStore.giveUp(!0)}},Object(m.e)(this,{connectionId:m.f,isConnected:m.f,setIsConnected:m.b,closeConnection:m.b}),this.rootStore=a;var i=Object(b.a)(p);this.db=Object(g.a)(i)},L=n(5);!function(e){e.EASY="easy",e.MEDIUM="medium",e.HARD="hard"}(O||(O={})),function(e){e.HOST="host",e.CLIENT="client"}(x||(x={}));var y,T=(R={},Object(L.a)(R,O.EASY,[{word:"camomile",soundSrc:"sounds/camomile.mp3",imageSrc:"imagesWords/romashka.jpg"},{word:"airplane",soundSrc:"sounds/airplane.mp3",imageSrc:"imagesWords/samolet.jpg"},{word:"orange",soundSrc:"sounds/orange.mp3",imageSrc:"imagesWords/apelsin.jpg"},{word:"shark",soundSrc:"sounds/shark.mp3",imageSrc:"imagesWords/akula.jpg"},{word:"dog",soundSrc:"sounds/dog.mp3",imageSrc:"imagesWords/sobaka.jpg"},{word:"monkey",soundSrc:"sounds/monkey.mp3",imageSrc:"imagesWords/obezana.jpg"},{word:"frog",soundSrc:"sounds/frog.mp3",imageSrc:"imagesWords/lagushka.jpg"},{word:"tomato",soundSrc:"sounds/tomato.mp3",imageSrc:"imagesWords/pomidor.jpg"},{word:"dragonfly",soundSrc:"sounds/dragonfly.mp3",imageSrc:"imagesWords/strekoza.jpg"},{word:"chick",soundSrc:"sounds/chick.mp3",imageSrc:"imagesWords/tciplenok.jpg"}]),Object(L.a)(R,O.MEDIUM,[{word:"caterpillar",soundSrc:"sounds/caterpillar.mp3",imageSrc:"imagesWords/gusenica.jpg"},{word:"banana",soundSrc:"sounds/banana.mp3",imageSrc:"imagesWords/banan.jpg"},{word:"barrel",soundSrc:"sounds/barrel.mp3",imageSrc:"imagesWords/bochka.jpg"},{word:"cow",soundSrc:"sounds/cow.mp3",imageSrc:"imagesWords/corowa.jpg"},{word:"lily",soundSrc:"sounds/lily.mp3",imageSrc:"imagesWords/lilia.jpg"},{word:"eggplant",soundSrc:"sounds/eggplant.mp3",imageSrc:"imagesWords/baklajan.jpg"},{word:"rocket",soundSrc:"sounds/rocket.mp3",imageSrc:"imagesWords/raketa.jpg"},{word:"dolphin",soundSrc:"sounds/dolphin.mp3",imageSrc:"imagesWords/delfin.jpg"},{word:"zebra",soundSrc:"sounds/zebra.mp3",imageSrc:"imagesWords/zebra.jpg"},{word:"flashlight",soundSrc:"sounds/flashlight.mp3",imageSrc:"imagesWords/fonarik.jpg"}]),Object(L.a)(R,O.HARD,[{word:"pizza",soundSrc:"sounds/pizza.mp3",imageSrc:"imagesWords/picca.jpg"},{word:"elephant",soundSrc:"sounds/elephant.mp3",imageSrc:"imagesWords/slon.jpg"},{word:"umbrella",soundSrc:"sounds/umbrella.mp3",imageSrc:"imagesWords/zont.jpg"},{word:"boat",soundSrc:"sounds/boat.mp3",imageSrc:"imagesWords/lodka.jpg"},{word:"potato",soundSrc:"sounds/potato.mp3",imageSrc:"imagesWords/kartofel.jpg"},{word:"lemon",soundSrc:"sounds/lemon.mp3",imageSrc:"imagesWords/limon.jpeg"},{word:"squid",soundSrc:"sounds/squid.mp3",imageSrc:"imagesWords/kalmar.jpg"},{word:"glasses",soundSrc:"sounds/glasses.mp3",imageSrc:"imagesWords/ochki.jpg"},{word:"shoes",soundSrc:"sounds/shoes.mp3",imageSrc:"imagesWords/tufli.jpg"},{word:"woodpecker",soundSrc:"sounds/woodpecker.mp3",imageSrc:"imagesWords/datel.jpg"}]),R),E=function e(t){var n=this,a=t.rootStore;Object(l.a)(this,e),this.START_LIFES_AMOUNT=3,this.REWARD_FOR_SECOND=100,this.REWARD_FOR_LIFE=100,this.difficulty=O.EASY,this.playerType=x.HOST,this.gameId="",this.rootStore=void 0,this.isGameStarted=!1,this.isGameEnded=!1,this.heroScore=0,this.rivalScore=0,this.exercises=[],this.currentBattleIndex=0,this.heroBattleResult=void 0,this.rivalBattleResult=void 0,this.hasRivalRequestedRestart=!1,this.hasHeroRequestedRestart=!1,this.rivalLifesAmount=3,this.setDifficulty=function(e){n.difficulty=e},this.setPlayerType=function(e){n.playerType=e},this.setScore=function(e,t){n.heroScore=e,n.rivalScore=t},this.getExercises=function(){n.exercises=function(e){for(var t=Object(h.a)(e),n=t.length-1;n>0;n--){var s=Math.floor(Math.random()*(n+1)),a=[t[s],t[n]];t[n]=a[0],t[s]=a[1]}return t}(T[n.difficulty]).slice(0,10)},this.startGame=function(){n.setScore(0,0),n.currentBattleIndex=0,n.hasRivalRequestedRestart=!1,n.hasHeroRequestedRestart=!1,n.rivalLifesAmount=n.START_LIFES_AMOUNT,n.rootStore.pageStore.changePage("battle"),n.playerType===x.HOST&&(n.rootStore.connectionStore.sendMessage({type:s.START_GAME}),n.getExercises(),n.startBattle())},this.startBattle=function(e){if(n.rivalBattleResult=null,n.heroBattleResult=null,n.isGameStarted=!0,n.rivalLifesAmount=n.START_LIFES_AMOUNT,e)n.rootStore.battleStore.startBattle(e);else{var t=n.exercises[n.currentBattleIndex];n.rootStore.connectionStore.sendMessage({type:s.START_BATTLE,exercise:t}),n.rootStore.battleStore.startBattle(t)}},this.addScores=function(){var e,t,s,a;n.heroScore+=(null===(e=n.heroBattleResult)||void 0===e?void 0:e.lifesLeft)&&(null===(t=n.heroBattleResult)||void 0===t?void 0:t.secondsLeft)?100*n.heroBattleResult.lifesLeft+100*n.heroBattleResult.secondsLeft:0,n.rivalScore+=(null===(s=n.rivalBattleResult)||void 0===s?void 0:s.lifesLeft)&&(null===(a=n.rivalBattleResult)||void 0===a?void 0:a.secondsLeft)?100*n.rivalBattleResult.lifesLeft+100*n.rivalBattleResult.secondsLeft:0},this.saveBattleResult=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?(n.rivalBattleResult=e,n.heroBattleResult&&n.endBattle()):(n.rootStore.connectionStore.sendMessage(Object(u.a)({type:s.FINISH_EXERCISE},e)),n.heroBattleResult=e,n.rivalBattleResult&&n.endBattle())},this.endGame=function(){n.isGameEnded=!0,n.rootStore.pageStore.changePage("battleInfo")},this.endBattle=function(){n.currentBattleIndex++,n.addScores(),n.currentBattleIndex>=10&&n.playerType===x.HOST&&(n.rootStore.connectionStore.sendMessage({type:s.END_GAME}),n.endGame())},this.saveRestartRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?n.hasRivalRequestedRestart=!0:(n.hasHeroRequestedRestart=!0,n.rootStore.connectionStore.sendMessage({type:s.REQUEST_RESTART})),n.hasHeroRequestedRestart&&n.hasRivalRequestedRestart&&n.playerType===x.HOST&&n.startGame()},this.reduceRivalLifes=function(){n.rivalLifesAmount--},this.abortGame=function(){n.rootStore.pageStore.changePage("mainMenu"),n.rootStore.connectionStore.closeConnection(),n.gameId=""},this.giveUp=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?n.rivalScore=-1:(n.heroScore=-1,n.rootStore.connectionStore.sendMessage({type:s.GIVE_UP})),n.endGame()},Object(m.e)(this,{difficulty:m.f,playerType:m.f,gameId:m.f,isGameStarted:m.f,isGameEnded:m.f,heroScore:m.f,rivalScore:m.f,heroBattleResult:m.f,rivalBattleResult:m.f,hasRivalRequestedRestart:m.f,hasHeroRequestedRestart:m.f,rivalLifesAmount:m.f,setDifficulty:m.b,setPlayerType:m.b,setScore:m.b,getExercises:m.b,startGame:m.b,startBattle:m.b,addScores:m.b,saveBattleResult:m.b,endGame:m.b,endBattle:m.b,saveRestartRequest:m.b,reduceRivalLifes:m.b,abortGame:m.b,giveUp:m.b}),this.rootStore=a,this.heroBattleResult=null,this.rivalBattleResult=null},I=function e(){var t=this;Object(l.a)(this,e),this.activePageName="mainMenu",this.changePage=function(e){t.activePageName=e},Object(m.e)(this,{activePageName:m.f,changePage:m.b})},C=function e(t){var n=this,a=t.rootStore;Object(l.a)(this,e),this.exerciseData=null,this.rootStore=void 0,this.counterLife=void 0,this.listLetter=void 0,this.isMistake=void 0,this.isPlayingSound=void 0,this.isCorrectAnswer=void 0,this.activeLetter=void 0,this.counterTimer=void 0,this.timerId=void 0,this.deadline=void 0,this.losing=void 0,this.startBattle=function(e){n.counterTimer=20,n.listLetter=[],n.counterLife=n.rootStore.gameStore.START_LIFES_AMOUNT,n.timerId=0,n.deadline="20",n.exerciseData=e,n.isMistake=!1,n.activeLetter="",n.isPlayingSound=!1,n.isCorrectAnswer=!1,n.losing=!1},this.updateTimer=function(){n.counterTimer-=1,n.deadline="".concat(n.counterTimer),n.counterTimer<10&&(n.deadline="0".concat(n.counterTimer)),0===n.counterTimer&&n.limitDeadline(),n.counterTimer<0&&(n.deadline="00")},this.timer=function(){n.timerId=window.setInterval(n.updateTimer,1e3)},this.startTimer=function(){n.timer()},this.limitDeadline=function(){n.losing=!0,n.addLetters(),n.endBattle()},this.setActiveLetter=function(e){n.activeLetter=e},this.getMistake=function(){return n.isMistake},this.setPlayingSound=function(e){n.isPlayingSound=e},this.setMistake=function(e){n.isMistake=e},this.getListLetter=function(){return n.listLetter},this.setLetter=function(e){if(n.setActiveLetter(e),n.checkMistake(n.checkLetter(e)),n.isMistake)return n.counterLife-=1,n.rootStore.connectionStore.sendMessage({type:s.REDUCE_LIFES}),void n.checkCountLife();n.listLetter.push(e),n.setActiveLetter(""),n.checkWord()},this.checkCountLife=function(){0===n.counterLife&&(n.losing=!0,n.addLetters(),n.endBattle())},this.checkWord=function(){var e;n.listLetter.length===(null===(e=n.exerciseData)||void 0===e?void 0:e.word.length)&&n.endBattle()},this.checkMistake=function(e){n.setMistake(e)},this.checkLetter=function(e){var t,s=n.listLetter.length;return(null===(t=n.exerciseData)||void 0===t?void 0:t.word[s])!==e},this.addLetters=function(){var e,t=n.listLetter.length,s=null===(e=n.exerciseData)||void 0===e?void 0:e.word,a=null===s||void 0===s?void 0:s.slice(t);null===a||void 0===a||a.split("").map((function(e){return n.listLetter.push(e)}))},this.endBattle=function(){n.losing||(n.isCorrectAnswer=!0),clearInterval(n.timerId);var e={secondsLeft:n.counterTimer,lifesLeft:n.counterLife};n.rootStore.gameStore.saveBattleResult(e)},Object(m.e)(this,{counterLife:m.f,listLetter:m.f,isMistake:m.f,activeLetter:m.f,isPlayingSound:m.f,isCorrectAnswer:m.f,counterTimer:m.f,timerId:m.f,deadline:m.f,exerciseData:m.f,losing:m.f,setLetter:m.b,setMistake:m.b,setActiveLetter:m.b,setPlayingSound:m.b,timer:m.b,updateTimer:m.b,startBattle:m.b,endBattle:m.b}),this.rootStore=a,this.counterLife=this.rootStore.gameStore.START_LIFES_AMOUNT,this.listLetter=[],this.isMistake=!1,this.activeLetter="",this.isPlayingSound=!1,this.isCorrectAnswer=!1,this.counterTimer=20,this.timerId=0,this.deadline="20",this.losing=!1},k=function e(){Object(l.a)(this,e),this.pageStore=void 0,this.gameStore=void 0,this.connectionStore=void 0,this.battleStore=void 0,this.pageStore=new I,this.gameStore=new E({rootStore:this}),this.connectionStore=new w({rootStore:this}),this.battleStore=new C({rootStore:this})},A=Object(d.createContext)({}),B=function(){return Object(d.useContext)(A)},M=(n(44),n(45),n(12)),W=(n(46),Object(o.a)((function(){var e=Object(d.useState)(""),t=Object(M.a)(e,2),n=t[0],s=t[1],a=Object(d.useState)(!1),i=Object(M.a)(a,2),c=i[0],o=i[1],l=B(),u=l.pageStore,m=l.connectionStore,h=m.isConnected,f=function(){var e=Object(v.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,m.startClientSession(n);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){h&&u.changePage("battleInfo")}),[h]),Object(r.jsxs)("div",{className:"connectionForm",children:[c?"Connecting...":Object(r.jsxs)("form",{className:"formWrapper",onSubmit:f,children:["Enter game code:",Object(r.jsx)("input",{value:n,onChange:function(e){return s(e.target.value)},placeholder:"Enter the code",className:"input"}),Object(r.jsx)("input",{value:"Connect",type:"submit",className:"button"})]}),Object(r.jsx)(z,{})]})}))),_=(n(47),Object(o.a)((function(){var e=B(),t=e.gameStore,n=e.connectionStore,s=n.isConnected,a=n.connectionId,i=t.playerType,c=t.isGameEnded,o=t.hasHeroRequestedRestart,l=t.heroScore,d=t.rivalScore,u=!1,m=!1,h=!1;l>d&&(u=!0),d>l&&(m=!0),d===l&&(h=!0);var f=o?Object(r.jsx)("div",{className:"waiting",children:"Waiting for the enemy"}):Object(r.jsx)(J,{type:"game"});return Object(r.jsxs)("div",{className:"battleInfo",children:[i===x.HOST&&!s&&Object(r.jsxs)("div",{className:"battleCode",children:["Game code: ",a,". Send it to your friend."]}),Object(r.jsxs)("div",{className:"fighter hero",children:[Object(r.jsx)("div",{className:"avatarHero"}),c&&Object(r.jsxs)("div",{className:"counterResult",children:[l," ",Object(r.jsx)("span",{children:"points"})]}),c&&u&&Object(r.jsx)("div",{className:"cup"})]}),Object(r.jsxs)("div",{className:"versus",children:["VS",c&&h&&Object(r.jsx)("div",{className:"deadHeat"})]}),s?Object(r.jsxs)("div",{className:"fighter rival",children:[Object(r.jsx)("div",{className:"avatarRival"}),c&&Object(r.jsxs)("div",{className:"counterResult",children:[d," ",Object(r.jsx)("span",{children:"points"})]}),c&&m&&Object(r.jsx)("div",{className:"cup"})]}):"Waiting for the enemy...",Object(r.jsx)(z,{}),i===x.HOST&&s&&f,i===x.CLIENT&&c&&f]})}))),D=n(33),G=n.n(D),P=n(16),F=n.n(P),H=(n(55),{mainMenu:function(){var e=B(),t=e.gameStore,n=e.pageStore,s=e.connectionStore;return Object(r.jsxs)("div",{className:"mainPage",children:[Object(r.jsx)("div",{className:"titlePage",children:"Spelling game"}),Object(r.jsxs)("div",{className:"wrapperButton",children:[Object(r.jsx)(q,{handleClick:function(){t.setPlayerType(x.HOST),n.changePage("difficultyChoice"),s.startHostSession()},text:"Create battle"}),Object(r.jsx)(q,{handleClick:function(){t.setPlayerType(x.CLIENT),n.changePage("connectionForm")},text:"Connect to battle"})]})]})},difficultyChoice:function(){var e,t=B(),n=t.gameStore,s=t.pageStore,a=(e={},Object(L.a)(e,O.EASY,"Easy"),Object(L.a)(e,O.MEDIUM,"Medium"),Object(L.a)(e,O.HARD,"Hard"),e);return Object(r.jsxs)("div",{className:"difficultyPage",children:[Object(r.jsx)("div",{className:"titlePage",children:"Choose difficulty"}),Object(r.jsx)("div",{className:"wrapperButton",children:Object.values(O).map((function(e){return Object(r.jsx)(q,{handleClick:function(){return function(e){n.setDifficulty(e),s.changePage("battleInfo")}(e)},text:a[e]},e)}))}),Object(r.jsx)(z,{})]})},connectionForm:W,battleInfo:_,battle:Object(o.a)((function(){var e=B(),t=e.battleStore,n=e.gameStore,s=t.counterLife,a=t.exerciseData,i=t.isPlayingSound,c=t.isCorrectAnswer,o=t.deadline,l=t.losing,u=n.playerType,m=n.heroBattleResult,h=n.rivalBattleResult,f=n.rivalLifesAmount,j=t.getListLetter(),v={backgroundImage:"url(".concat(null===a||void 0===a?void 0:a.imageSrc,")")},b=m&&h,g=Object(d.useState)(!1),S=Object(M.a)(g,2),p=S[0],O=S[1];Object(d.useEffect)((function(){O(!0)}),[a]);var R=F()("exercise",{correctAnswer:c,losing:l});return Object(r.jsxs)("div",{className:"pageBattle",children:[Object(r.jsxs)("div",{className:"headerWrapper",children:[Object(r.jsxs)("div",{className:"leftContainer characterInfoContainer",children:[Object(r.jsxs)("div",{className:"topLine",children:[Object(r.jsx)("div",{className:"avatar"}),Object(r.jsxs)("div",{className:"nameContainer",children:[Object(r.jsx)("div",{className:"nickname",children:"You"}),Object(r.jsx)(Y,{count:s})]})]}),Object(r.jsx)($,{})]}),Object(r.jsx)("div",{className:"centerContainer",children:"0:".concat(o)}),Object(r.jsxs)("div",{className:"rightContainer characterInfoContainer",children:[Object(r.jsxs)("div",{className:"topLine",children:[Object(r.jsx)("div",{className:"avatar"}),Object(r.jsxs)("div",{className:"nameContainer",children:[Object(r.jsx)("div",{className:"nickname",children:"Enemy"}),Object(r.jsx)(Y,{count:f})]})]}),Object(r.jsx)($,{isRival:!0})]})]}),b?Object(r.jsxs)("div",{className:"battleResultWrapper",children:[Object(r.jsx)(ee,{}),Object(r.jsx)(ee,{isRival:!0})]}):p?Object(r.jsx)(Z,{callback:function(){O(!1),t.setPlayingSound(!0),t.startTimer()}}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"exerciseContainer",children:Object(r.jsxs)("div",{className:R,children:[Object(r.jsxs)("div",{className:"imageExercise",style:v,onClick:function(){t.setPlayingSound(!0)},children:[a&&Object(r.jsx)(G.a,{src:a.soundSrc,playing:i,onEnd:function(){t.setPlayingSound(!1)},format:["mp3"]}),Object(r.jsx)("div",{className:"soundIcon"})]}),Object(r.jsx)(Q,{letters:j,isCorrectAnswer:c,losing:l})]})}),Object(r.jsx)("div",{className:"keyBoardWrapper",children:Object(r.jsx)("div",{className:"keyBoardContainer",children:Object(r.jsx)("div",{className:"keyBoardItem"})})}),Object(r.jsx)(z,{})]}),u===x.HOST&&b&&Object(r.jsx)(J,{type:"battle"})]})}))}),U=Object(o.a)((function(){var e=B().pageStore,t=H[e.activePageName];return Object(r.jsx)(t,{})}));n(56);!function(e){e.MAIN_MENU="mainMenu",e.START_GAME="startGame"}(y||(y={}));var q=function(e){var t=e.type,n=e.handleClick,s=e.text;return Object(r.jsx)("div",{className:F()("button",t),onClick:n,children:s})},z=function(){var e=B().gameStore,t=e.isGameStarted,n=e.isGameEnded,s=t&&!n;return Object(r.jsx)(q,{type:y.MAIN_MENU,handleClick:function(){return s?e.giveUp():e.abortGame()},text:s?"Give up":"Main page"})},J=function(e){var t=e.type,n=B().gameStore,s=n.isGameEnded;return Object(r.jsx)(q,{type:y.START_GAME,handleClick:function(){switch(t){case"game":s?n.saveRestartRequest():n.startGame();break;case"battle":n.startBattle()}},text:function(){switch(t){case"game":return s?"New game":"Start";case"battle":return"Next word";default:return""}}()})},V=(n(57),function(e){var t=e.isDisabled,n=F()("lifeElement",{disabledElem:t});return Object(r.jsx)("div",{className:n})}),Y=(n(58),Object(o.a)((function(e){for(var t=e.count,n=[],s=1;s<4;s++)s<=t?n.push(Object(r.jsx)(V,{isDisabled:!1},"lifeItem_".concat(s))):n.push(Object(r.jsx)(V,{isDisabled:!0},"lifeItem_".concat(s)));return Object(r.jsx)("div",{className:"lifeList",children:n})}))),X=(n(59),function(e){var t=e.letter;return Object(r.jsx)("div",{className:"letterAnswer",children:t})}),Q=(n(60),Object(o.a)((function(e){var t=e.letters,n=e.isCorrectAnswer,s=e.losing;return Object(r.jsxs)("div",{className:"wordAnswer",children:[t.map((function(e,t){return Object(r.jsx)(X,{letter:e},"LetterAnswer_".concat(t))})),!n&&!s&&Object(r.jsx)(K,{})]})}))),K=(n(61),Object(o.a)((function(){var e=B().battleStore,t=e.activeLetter,n=e.getMistake(),s=F()("inputLetterContainer",{hide:!1,mistake:n});return Object(r.jsx)("div",{className:s,children:Object(r.jsx)("input",{type:"text",className:"inputLetter",autoFocus:!0,maxLength:1,onChange:function(t){var n=t.currentTarget.value;n.length>1&&e.setActiveLetter(""),""!==n?e.setLetter(n):e.setActiveLetter("")},value:t})})}))),Z=(n(62),function(e){var t=e.callback,n=Object(d.useState)(3),s=Object(M.a)(n,2),a=s[0],i=s[1];return Object(d.useEffect)((function(){0===a?t():window.setTimeout((function(){i(a-1)}),1e3)}),[a]),Object(r.jsx)("div",{className:"countdown",children:a})}),$=(n(63),function(e){var t=e.isRival,n=void 0!==t&&t,s=B().gameStore,a=n?s.rivalScore:s.heroScore,i=Object(d.useRef)(a),c=Object(d.useState)(a),o=Object(M.a)(c,2),l=o[0],u=o[1],m=Object(d.useRef)(0),h=function(){var e=Object(v.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,n=function e(n){t||(t=n);var s=Math.min((n-t)/500,1);u(Math.floor(i.current+s*(a-i.current))),s<1?m.current=window.requestAnimationFrame(e):i.current=a},m.current=window.requestAnimationFrame(n);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(d.useEffect)((function(){window.cancelAnimationFrame(m.current),h()}),[a]),Object(r.jsxs)("div",{className:"scoreWrapper",children:[Object(r.jsx)("div",{className:"scoreNumber",children:l}),Object(r.jsx)("div",{className:"starWrapper",children:Object(r.jsx)("div",{className:"star"})})]})}),ee=(n(64),function(e){var t,n=e.isRival,s=void 0!==n&&n,a=B().gameStore,i=a.REWARD_FOR_LIFE,c=a.REWARD_FOR_SECOND,o=s?a.rivalBattleResult:a.heroBattleResult,l=o.lifesLeft*i,d=o.secondsLeft*c,u=l&&d?l+d:0;return Object(r.jsxs)("div",{className:"battleResult",children:[u>0&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"scoreWrapper life",children:[Object(r.jsx)("div",{className:"scoreImage",children:(t=o.lifesLeft,Array.from({length:t},(function(e,t){return t}))).map((function(e){return Object(r.jsx)("div",{className:"icon"},e)}))}),"* ",i," = ",l]}),Object(r.jsxs)("div",{className:"scoreWrapper time",children:[Object(r.jsxs)("div",{className:"scoreImage",children:[Object(r.jsx)("div",{className:"icon"})," 0:",String(o.secondsLeft).padStart(2,"0")]}),"* ",c," = ",d]})]}),Object(r.jsxs)("div",{className:"scoreWrapper score",children:[Object(r.jsx)("div",{className:"scoreImage",children:Object(r.jsx)("div",{className:"icon"})})," ","+",u]})]})});n(65);function te(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsx)(c,{children:Object(r.jsx)(U,{})})})}n(68),n(66);!function(){var e=new k;window.DEBUG_STORE=e,i.a.render(Object(r.jsx)(A.Provider,{value:e,children:Object(r.jsx)(te,{})}),document.getElementById("root"))}()}},[[67,1,2]]]);
//# sourceMappingURL=main.7a1127ae.chunk.js.map